---
layout:     post
title:      "表单重复提交"
subtitle:   " \"如何防止表单重复提交\""
date:       2018-10-24 06:00:00
author:     "青乡"
header-img: "img/post-bg-2015.jpg"
catalog: true
tags:
    - web
---

# 表单重复提交是怎么产生的

# 有哪几种情况会产生表单重复提交

1.网络原因

请求有点慢，导致点了好几次。

2.刷新页面

再次提交。

3.回退页面

相当于刷新页面。

然后，再次提交。

# 参考

[https://www.jianshu.com/p/01b6ab61f24a](https://www.jianshu.com/p/01b6ab61f24a)

# 如何解决

#### 从前端和后台划分

一、前端和后台同时控制
1.思路
按钮置灰和后台代码同时控制。

2.应用场景
点击支付。步骤，

1）前端置灰

按钮disable。
2）后端使用缓存校验是否重复提交
缓存？
token，怎么传递token？
缓存过期时间控制？

二、后台控制
1.思路
缓存
1）有
不重复处理，直接返回。

2）没有
正常处理业务。

2.应用场景
订单支付是否成功。

业务背景

1）已经生成本地订单数据，但是状态是未支付。

2）定时器任务去扫数据库，在接下来的业务当作，校验数据的时候，需要校验订单状态是否支付。

校验步骤
1）成功
不记账更新和更新订单状态。
2）未支付
记账和更新订单状态。

#### 从技术实现划分

一、把数据保存在会话对象

1.优点

简单。不需要安装第三方中间件软件。

缺点

一般存少量数据，特别重要的数据。

2.底层原理

基于web服务器的会话对象。

3.应用场景

保持用户登录。

二、把数据保存在缓存中间件

1.优点

一般用于大量的数据。

缺点

需要安装第三方中间件软件。

2.底层原理

3.应用场景

# 几个问题
1.代码重新加载
重新下载。

2.代码是否重新渲染
不管是浏览器缓存还是服务器重新下载代码，浏览器都会重新渲染前端代码。

3.表单是否重新提交 



